<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>æ´»å‹•å ±åè¡¨</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">
  <style>
  /* ===== å…¨ç«™èƒŒæ™¯ ===== */
  body {
    padding-top: 50px;
    background: #1f2430;
    font-family: "Noto Sans TC", "Helvetica Neue", Arial, sans-serif;
    color: #e6e9f0;
  }

  /* ===== ç»ç’ƒå¡ç‰‡å®¹å™¨ ===== */
  .container {
    max-width: 600px;
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
  }

  /* ===== æ¨™ç±¤æ–‡å­— ===== */
  label {
    color: #cfd6ff;
    font-weight: 600;
    margin-bottom: 6px;
  }

  /* ===== æ‰€æœ‰è¼¸å…¥èˆ‡ä¸‹æ‹‰ï¼ˆSkeleton è¦†è“‹ï¼‰ ===== */
  .container input,
  .container select {
    background: rgba(255, 255, 255, 0.14) !important;
    background-color: rgba(255, 255, 255, 0.14) !important;
    border: 1px solid rgba(255, 255, 255, 0.35) !important;
    color: #ffffff !important;
    -webkit-text-fill-color: #ffffff !important;
    border-radius: 8px;
    height: 44px;
  }

  /* ===== placeholder ===== */
  .container input::placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
  }

  /* ===== focus ç‹€æ…‹ ===== */
  .container input:focus,
  .container select:focus {
    border-color: #ff8acb !important;
    box-shadow: 0 0 0 2px rgba(255, 138, 203, 0.3) !important;
    outline: none;
  }

  /* ===== select option é¡è‰² ===== */
  .container option {
    color: #1f2430;
  }

  /* ===== é˜²æ­¢ç€è¦½å™¨ autofill è®Šç™½ï¼ˆé—œéµï¼‰ ===== */
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus {
    -webkit-text-fill-color: #ffffff !important;
    transition: background-color 9999s ease-out 0s;
    box-shadow: 0 0 0 1000px rgba(255, 255, 255, 0.14) inset !important;
  }

  /* ===== ä¸»è¦æŒ‰éˆ• ===== */
  button.button-primary {
    width: 100%;
    height: 48px;
    font-size: 1.4rem;
    font-weight: 700;
    border: none;
    border-radius: 10px;
    background: linear-gradient(
      135deg,
      #6ea8ff 0%,
      #b98cff 45%,
      #ff8acb 75%,
      #ffb07a 100%
    );
    color: #1f2430;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }

  button.button-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 10px 25px rgba(255, 138, 203, 0.35);
  }

  /* ===== æˆåŠŸè¨Šæ¯ ===== */
  .success-msg {
    display: none;
    color: #7dffb3;
    font-weight: bold;
    text-align: center;
    margin-top: 24px;
    font-size: 1.2rem;
  }

</style>


</head>
<body>

<div class="container">
  <form id="registrationForm">
    <div class="row">
      <label for="identity">èº«ä»½åˆ¥</label>
      <select class="u-full-width" id="identity" required>
        <option value="">è«‹é¸æ“‡èº«ä»½</option>
        <option value="ç£Šå±±äºº">ç£Šå±±äºº</option>
        <option value="ä¾†è³“">ä¾†è³“</option>
      </select>
    </div>

    <div class="row">
      <label for="unit">æ‰€å±¬å–®ä½</label>
      <select class="u-full-width" id="unit" required>
        <option value="">è«‹é¸æ“‡å–®ä½</option>
        <option value="é¦–éƒ½ç‡Ÿé‹è™•">é¦–éƒ½ç‡Ÿé‹è™•</option>
        <option value="å®¸æ¯…ç‡Ÿé‹è™•">å®¸æ¯…ç‡Ÿé‹è™•</option>
        <option value="ç£Šæ˜Ÿç‡Ÿé‹è™•">ç£Šæ˜Ÿç‡Ÿé‹è™•</option>
        <option value="èª èŠ¯ç‡Ÿé‹è™•">èª èŠ¯ç‡Ÿé‹è™•</option>
        <option value="å¤©åŒç‡Ÿé‹è™•">å¤©åŒç‡Ÿé‹è™•</option>
        <option value="å¾¡è¬™ç‰¹è¨±åˆ†è¡Œ">å¾¡è¬™ç‰¹è¨±åˆ†è¡Œ</option>
        <option value="é›‹å±±ç‰¹è¨±ç‡Ÿé‹è™•">é›‹å±±ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="æ·èºç‰¹è¨±åˆ†è¡Œ">æ·èºç‰¹è¨±åˆ†è¡Œ</option>
        <option value="é ‚ç››ç‡Ÿé‹è™•">é ‚ç››ç‡Ÿé‹è™•</option>
        <option value="ç¿”é›ç‰¹è¨±åˆ†è¡Œ">ç¿”é›ç‰¹è¨±åˆ†è¡Œ</option>
        <option value="æ±Ÿå—ç‰¹è¨±ç‡Ÿé‹è™•">æ±Ÿå—ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="åœ“æ–¹ç‰¹è¨±åˆ†è¡Œ">åœ“æ–¹ç‰¹è¨±åˆ†è¡Œ</option>
        <option value="é‰…é‘«ç‡Ÿé‹è™•">é‰…é‘«ç‡Ÿé‹è™•</option>
        <option value="é¼å³°ç‡Ÿé‹è™•">é¼å³°ç‡Ÿé‹è™•</option>
        <option value="é¦–éƒ½åˆ†è¡Œ">é¦–éƒ½åˆ†è¡Œ</option>
        <option value="é«˜æˆç‰¹è¨±åˆ†è¡Œ(å°åŒ—)">é«˜æˆç‰¹è¨±åˆ†è¡Œ(å°åŒ—)</option>
        <option value="å®œè˜­ç‡Ÿé‹è™•">å®œè˜­ç‡Ÿé‹è™•</option>
        <option value="æ¡ƒåœ’ç‡Ÿé‹è™•">æ¡ƒåœ’ç‡Ÿé‹è™•</option>
        <option value="é‘«ç¿”ç‰¹è¨±ç‡Ÿé‹è™•">é‘«ç¿”ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="é¨°èºç‡Ÿé‹è™•">é¨°èºç‡Ÿé‹è™•</option>
        <option value="è‡»æ–°ç‰¹è¨±ç‡Ÿé‹è™•">è‡»æ–°ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="æ–°ç«¹ç‡Ÿé‹è™•">æ–°ç«¹ç‡Ÿé‹è™•</option>
        <option value="é«˜æˆç‰¹è¨±åˆ†è¡Œ(æ–°ç«¹)">é«˜æˆç‰¹è¨±åˆ†è¡Œ(æ–°ç«¹)</option>
        <option value="æ—­åŸç‡Ÿé‹è™•(æ–°ç«¹)">æ—­åŸç‡Ÿé‹è™•(æ–°ç«¹)</option>
        <option value="ä»•é‘«ç‡Ÿé‹è™•">ä»•é‘«ç‡Ÿé‹è™•</option>
        <option value="å°ä¸­ç‡Ÿé‹è™•">å°ä¸­ç‡Ÿé‹è™•</option>
        <option value="é«˜æˆç‰¹è¨±åˆ†è¡Œ(å°ä¸­)">é«˜æˆç‰¹è¨±åˆ†è¡Œ(å°ä¸­)</option>
        <option value="ç£Šæ˜Ÿç‡Ÿé‹è™•(å°ä¸­)">ç£Šæ˜Ÿç‡Ÿé‹è™•(å°ä¸­)</option>
        <option value="æ—­åŸç‡Ÿé‹è™•">æ—­åŸç‡Ÿé‹è™•</option>
        <option value="å—æŠ•ç‰¹è¨±ç‡Ÿé‹è™•">å—æŠ•ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="ç£Šæ˜Ÿç‡Ÿé‹è™•(å°å—)">ç£Šæ˜Ÿç‡Ÿé‹è™•(å°å—)</option>
        <option value="å¾—å‹ç‡Ÿé‹è™•">å¾—å‹ç‡Ÿé‹è™•</option>
        <option value="ç²¾è‹±ç‡Ÿé‹è™•">ç²¾è‹±ç‡Ÿé‹è™•</option>
        <option value="é«˜é›„ç‡Ÿé‹è™•">é«˜é›„ç‡Ÿé‹è™•</option>
        <option value="é«˜æˆç‰¹è¨±åˆ†è¡Œ">é«˜æˆç‰¹è¨±åˆ†è¡Œ</option>
        <option value="å¤©å¤©ç‰¹è¨±ç‡Ÿé‹è™•">å¤©å¤©ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="æ¦®ç›ˆç‡Ÿé‹è™•">æ¦®ç›ˆç‡Ÿé‹è™•</option>
        <option value="å¾·è¬™ç‰¹è¨±ç‡Ÿé‹è™•">å¾·è¬™ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="æ±çƒç‰¹è¨±ç‡Ÿé‹è™•">æ±çƒç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="å»£æ¦®ç‰¹è¨±ç‡Ÿé‹è™•">å»£æ¦®ç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="é¾èºç‰¹è¨±ç‡Ÿé‹è™•">é¾èºç‰¹è¨±ç‡Ÿé‹è™•</option>
        <option value="é‡‘é–€ç‰¹è¨±åˆ†è¡Œ">é‡‘é–€ç‰¹è¨±åˆ†è¡Œ</option>
      </select>
    </div>

    <div class="row">
      <label for="name">å§“å</label>
      <input class="u-full-width" type="text" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å" id="name" maxlength="50" required>
    </div>

    <div class="row">
      <label for="activity">åƒèˆ‡æ´»å‹•é¡åˆ¥(å¯è¤‡é¸)</label>
      <select class="u-full-width" id="activity" multiple size="3" required>
        <option value="æ™‰å‡å…¸ç¦®">æ™‰å‡å…¸ç¦®</option>
        <option value="ç£Šå±±ç¾¤è‹±æœƒ">ç£Šå±±ç¾¤è‹±æœƒ</option>
        <option value="ç¾¤è‹±æ™šå®´(é™æ™šå®´è³‡æ ¼å¤¥ä¼´)">ç¾¤è‹±æ™šå®´(é™æ™šå®´è³‡æ ¼å¤¥ä¼´)</option>
      </select>
    </div>

    <button class="button-primary" type="submit">æäº¤å ±å</button>
  </form>
  
  <div id="successMsg" class="success-msg">ğŸ‰ å ±åæˆåŠŸï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡ã€‚</div>
</div>

<script>
  const form = document.getElementById('registrationForm');
  const successMsg = document.getElementById('successMsg');

  const nameInput = document.getElementById('name');
  const activitySelect = document.getElementById('activity');

  // æ¡Œé¢ Chromeï¼šä¸ç”¨æŒ‰ Ctrl ä¹Ÿèƒ½é»ä¸€ä¸‹åˆ‡æ›
  activitySelect.addEventListener('mousedown', (e) => {
    if (e.target.tagName && e.target.tagName.toLowerCase() === 'option') {
      e.preventDefault();
    }
  });

  activitySelect.addEventListener('click', (e) => {
    if (e.target.tagName && e.target.tagName.toLowerCase() === 'option') {
      e.preventDefault();
      const option = e.target;

      setTimeout(() => {
        option.selected = !option.selected;
        activitySelect.dispatchEvent(new Event('change'));
      }, 0);
    }
  });

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    // ç§»é™¤å§“åä¸­çš„æ‰€æœ‰ç©ºç™½ï¼ˆå«å‰å¾Œèˆ‡ä¸­é–“ï¼‰
    nameInput.value = nameInput.value.replace(/\s+/g, '');

    const GOOGLE_FORM_URL =
      'https://docs.google.com/forms/u/0/d/e/1FAIpQLSeW15I0xwkQzmwV4kwzSNSTpiUj_xwJMp9jrWCamlag6mHjMg/formResponse';

    const formData = new FormData();
    formData.append('entry.1772185938', document.getElementById('identity').value);
    formData.append('entry.1343536439', document.getElementById('unit').value);
    formData.append('entry.397313131', nameInput.value);

    // å¤šé¸æ´»å‹•ï¼šåˆä½µæˆå­—ä¸²ï¼ˆç°¡ç­”é¡Œï¼‰
    const selectedActivities = Array.from(activitySelect.selectedOptions);
    const activityValue = selectedActivities.map(o => o.value).join('ã€');
    formData.append('entry.2059014195', activityValue);

    fetch(GOOGLE_FORM_URL, {
      method: 'POST',
      mode: 'no-cors',
      body: formData
    }).then(() => {
      form.style.display = 'none';
      successMsg.style.display = 'block';
    }).catch(error => {
      alert('æäº¤å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦ã€‚');
      console.error('Error!', error.message);
    });
  });
</script>

</body>
</html>
